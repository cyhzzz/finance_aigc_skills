# Step 3: 数据分析与解读

## 明确目标
基于获取的市场数据和板块数据，从专业投资顾问的角度，进行深度分析，包括技术面、资金面、市场情绪和板块轮动分析，为后市展望和投资建议提供依据。

## 具体操作

### 1. 使用哪些工具
- **Shell工具**：`scripts/analysis_tool.py`
- **数据库/API**：已获取的JSON数据文件
- **搜索工具**：不需要

### 2. 查询哪些数据表/字段

#### 技术面分析字段
| 数据类型 | 字段 | 分析用途 |
|---------|------|---------|
| 指数数据 | close, open, high, low | 计算涨跌幅、振幅 |
| 指数数据 | volume, amount | 分析成交量变化 |
| 指数数据 | 历史数据（如需） | 计算移动平均线、MACD等 |

#### 资金面分析字段
| 数据类型 | 字段 | 分析用途 |
|---------|------|---------|
| 北向资金 | net_inflow | 判断外资流向 |
| 市场统计 | total, volume, amount | 分析成交活跃度 |
| 市场统计 | volume_ratio | 量比分析 |

#### 市场情绪分析字段
| 数据类型 | 字段 | 分析用途 |
|---------|------|---------|
| 市场统计 | limit_up, limit_down | 涨跌比分析 |
| 市场统计 | rising, falling | 涨跌比计算 |
| 市场统计 | total | 计算上涨占比 |

#### 板块轮动分析字段
| 数据类型 | 字段 | 分析用途 |
|---------|------|---------|
| 板块数据 | top_risers（板块名称、涨跌幅） | 判断市场风格 |
| 板块数据 | top_fallers（板块名称、涨跌幅） | 判断资金流向 |
| 板块数据 | 成交额 | 判断板块活跃度 |

### 3. 筛选和排序规则

#### 技术面分析
- **筛选**：根据指数涨跌幅判断市场方向
- **排序**：按涨跌幅排序，找出领涨指数

#### 资金面分析
- **筛选**：根据北向资金净流入金额判断资金流向
- **判断**：>50亿为大幅流入，>0为小幅流入，<0为流出

#### 市场情绪分析
- **筛选**：根据上涨占比判断市场情绪
  - >75%：强势
  - 66%-75%：偏多
  - 50%-66%：中性
  - 33%-50%：偏空
  - <33%：弱势

#### 板块轮动分析
- **筛选**：根据领涨板块判断市场风格
  - 科技板块为主：科技成长
  - 消费板块为主：价值稳健
  - 周期板块为主：周期轮动

### 4. 计算逻辑

#### 上涨占比计算
```python
rising_pct = rising / total * 100
```

#### 涨跌比计算
```python
rise_fall_ratio = f"{rising}:{falling}"
```

#### 北向资金流向判断
```python
if net_inflow > 50:
    funds_direction = "大幅流入"
    sentiment = "偏多"
elif net_inflow > 0:
    funds_direction = "小幅流入"
    sentiment = "谨慎偏多"
elif net_inflow > -50:
    funds_direction = "小幅流出"
    sentiment = "偏空"
else:
    funds_direction = "大幅流出"
    sentiment = "悲观"
```

#### 市场情绪判断
```python
if rising_pct > 75:
    market_sentiment = "强势"
elif rising_pct > 66:
    market_sentiment = "偏多"
elif rising_pct > 50:
    market_sentiment = "中性"
elif rising_pct > 33:
    market_sentiment = "偏空"
else:
    market_sentiment = "弱势"
```

#### 赚钱效应判断
```python
if limit_up > limit_down * 5:
    earning_effect = "明显"
elif limit_up > limit_down * 2:
    earning_effect = "一般"
else:
    earning_effect = "较差"
```

### 5. 操作流程
```
1. 读取市场数据JSON文件
2. 分析指数表现（涨跌幅、方向）
3. 分析资金流向（北向资金）
4. 分析市场情绪（涨跌比、涨停家数）
5. 分析板块表现（领涨/领跌）
6. 判断市场风格（科技/消费/周期）
7. 生成分析结果
8. 保存为JSON格式
```

## 输出格式

### 数据文件格式
JSON格式，包含：
- date: 日期
- summary: 核心观点
- indices_analysis: 指数分析
- funds_analysis: 资金分析
- statistics_analysis: 统计分析
- sectors_analysis: 板块分析
- overall_sentiment: 整体情绪

### 用户回复格式
```
=== 数据分析与解读完成 ===

日期：2026-02-10

核心观点：
2026-02-10，A股市场呈现上涨态势。创业板指表现最强势，上涨1.34%。
北向资金大幅流入58.62亿元，市场情绪偏多。

指数分析：
- 市场方向: 上涨
- 上涨指数: 3个
- 下跌指数: 0个
- 表现最好: 创业板指

资金分析：
- 北向资金: 大幅流入 58.62亿元
- 市场情绪: 偏多

统计分析：
- 涨停家数: 125家
- 跌停家数: 3家
- 上涨家数: 3256家
- 下跌家数: 1789家
- 上涨占比: 60.7%
- 市场情绪: 中性
- 赚钱效应: 明显

板块分析：
- 领涨板块: 5个
- 领跌板块: 5个
- 市场风格: 科技成长
- Top 3板块: 人工智能, 半导体, 新能源车

综合判断：
- 整体情绪: 偏多

分析结论：
1. 技术面：三大指数集体收涨，呈现多头排列
2. 资金面：北向资金大幅净流入，显示外资看好A股
3. 市场情绪：涨停125家，跌停3家，赚钱效应明显
4. 板块轮动：科技板块全面走强，资金明显流向高成长板块
```

## 下一步预告

接下来将进入 **Step 4: 后市展望与投资建议**，包括：
- 短期观点（1-3个交易日）
- 中期观点（1-2周）
- 投资策略建议
- 关注方向
- 风险提示

请确认是否继续？
