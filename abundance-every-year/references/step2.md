# Step 2: 板块数据获取

## 明确目标
获取指定交易日的行业板块表现数据，包括领涨板块和领跌板块，以及市场涨跌统计，为市场情绪分析和板块轮动分析提供数据支持。

## 具体操作

### 1. 使用哪些工具
- **Shell工具**：`scripts/fetch_market_data.py`（已集成板块数据获取）
- **数据库/API**：akshare API
- **搜索工具**：不需要

### 2. 查询哪些数据表/字段

#### akshare API映射
| 数据类型 | akshare API | 核心字段 |
|---------|-------------|---------|
| 行业板块 | `ak.stock_board_industry_name_em()` | 板块名称, 最新价, 涨跌幅, 成交额 |
| 市场统计 | `ak.stock_zh_a_spot_em()` | 涨跌幅（用于统计） |

### 3. 筛选和排序规则

#### 领涨板块 Top 5
- **排序**：按涨跌幅从高到低排序
- **筛选**：选取前5个板块

#### 领跌板块 Top 5
- **排序**：按涨跌幅从低到高排序
- **筛选**：选取前5个板块

#### 涨跌统计
- **涨停家数**：涨跌幅 >= 9.9%
- **跌停家数**：涨跌幅 <= -9.9%
- **上涨家数**：涨跌幅 > 0
- **下跌家数**：涨跌幅 < 0

### 4. 计算逻辑

#### 涨跌比计算
```python
rise_fall_ratio = f"{rising}:{falling}"
rising_pct = rising / total * 100
```

#### 板块排序
```python
sector_sorted = sector_data.sort_values('涨跌幅', ascending=False)
top_risers = sector_sorted.head(5)    # 领涨 Top 5
top_fallers = sector_sorted.tail(5)   # 领跌 Top 5
```

### 5. 操作流程
```
1. 获取行业板块数据
2. 获取市场统计数据
3. 计算涨跌停家数
4. 计算涨跌比
5. 排序找出领涨/领跌板块
6. 保存为JSON格式
```

## 输出格式

### 数据文件格式
JSON格式，包含：
- statistics: 市场统计数据
- sectors: 板块数据（top_risers, top_fallers）

### 用户回复格式
```
=== 板块数据获取完成 ===

日期：2026-02-10

市场统计：
- 涨停家数：125家
- 跌停家数：3家
- 涨跌比：3256:1789（上涨占比60.7%）

市场特征：
- 涨停家数远超跌停家数
- 市场赚钱效应明显
- 情绪偏多

领涨板块 Top 5：
1. 人工智能：+2.69%，成交额1258.6亿元
2. 半导体：+2.48%，成交额985.6亿元
3. 新能源车：+2.35%，成交额856.8亿元
4. 光伏设备：+2.19%，成交额725.6亿元
5. 云计算：+2.18%，成交额685.2亿元

领跌板块 Top 5：
1. 房地产：-1.46%，成交额458.6亿元
2. 银行：-1.30%，成交额526.8亿元
3. 交通运输：-1.07%，成交额385.6亿元
4. 煤炭：-0.97%，成交额458.6亿元
5. 钢铁：-0.93%，成交额425.8亿元

板块特征：
- 科技板块全面走强（人工智能、半导体、云计算）
- 新能源板块表现活跃（新能源车、光伏设备）
- 传统板块表现疲弱（房地产、银行、煤炭）
- 资金明显流向高成长板块
```

## 下一步预告

接下来将进入 **Step 3: 数据分析与解读**，包括：
- 技术面分析（指数形态、支撑压力位）
- 资金面分析（北向资金、成交量）
- 市场情绪分析（涨跌比、涨跌停）
- 板块轮动分析

请确认是否继续？
